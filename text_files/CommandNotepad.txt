=====
perl hmmbuild_mult_seq.pl ../../sequence_files/prophage/all_prophage_seq.fasta
hmmpress all_prophage_seqs.hmm
nhmmscan --dfamtblout tables/test_run_table.dfam --cpu 3 prophage_seq/all_prophage_seqs.hmm genomes/Pseudomonas_aeruginosa_12-4-4_59__3618.fna
perl dfamscan.pl --dfam_infile  ../../tables/dfam/test_run_table.dfam --dfam_outfile ../../tables/dfam/test_run_filtered.dfam

perl hmmbuild_mult_seq.pl ../../sequence_files/att/att_seq.fasta
cat *.hmm > all_att_seq.hmm
hmmpress all_att_seq.hmm
nhmmscan --dfamtblout tables/att_test.dfam att_seq/all_att_seq.hmm genomes/Pseudomonas_aeruginosa_12-4-4_59__3618.fna
perl dfamscan.pl --dfam_infile  ../../tables/dfam/att_test.dfam --dfam_outfile ../../tables/dfam/att_test_scanned.dfam

=====
perl hmmbuild_mult_seq.pl ../../sequence_files/prophage/prophage_seq.fasta
cat *.hmm > all_prophage_seq.hmm
hmmpress all_prophage_seq.hmm
nhmmscan --dfamtblout tables/test_strain_names_viral.dfam --cpu 3 prophage_seq/all_prophage_seq.hmm genomes/Pseudomonas_aeruginosa_12-4-4_59__3618.fna
perl dfamscan.pl --dfam_infile  ../../tables/dfam/test_strain_names_viral.dfam --dfam_outfile ../../tables/dfam/names_viral_scanned.dfam

perl hmmbuild_mult_seq.pl ../../sequence_files/att/att_seq.fasta
cat *.hmm > all_att_seq.hmm
hmmpress all_att_seq.hmm
nhmmscan --dfamtblout tables/att_test.dfam att_seq/all_att_seq.hmm genomes/Pseudomonas_aeruginosa_12-4-4_59__3618.fna
perl dfamscan.pl --dfam_infile  ../../tables/dfam/att_names_test.dfam --dfam_outfile ../../tables/dfam/att_names_test_scanned.dfam

=====
perl tableizer.pl ../genomes/ ../prophage_seq/all_prophage_seq.hmm ../tables
perl tableizer.pl ../genomes/ ../att_seq/all_att_seq.hmm ../tables

=====
SPADES on WGS Sequence
spades_PAO1:
spades.py -1 PAO1_R1_001.fastq -2 PAO1_R2_001.fastq -o ~/assembled_genomes/Pat_WGS_Sequence/PAO1/

spades_PAO1_wt_Pf4:
spades.py -1 PAO1-wt-Pf4_R1_001.fastq -2 PAO1-wt-Pf4_R2_001.fastq -o ~/assembled_genomes/Pat_WGS_Sequence/PAO1_wt_Pf4/

spades_PAO1_rec_Pf4:
spades.py -1 PAO1-rec-Pf4_R1_001.fastq -2 PAO1-rec-Pf4_R2_001.fastq -o ~/assembled_genomes/Pat_WGS_Sequence/PAO1_rec_Pf4/

=====
NHMMER on SPADES Pseudomnas contigs

nhmmer --tblout prophage_search.tbl  -o prophage_search.afa Pf_prophage_strain_PAO1__Reference_strain_.fasta test.fasta
nhmmer --tblout 200_contigs.tbl  -o 200_contigs.out ../Pf_prophage_strain_PAO1__Reference_strain_.fasta 200_filtered_contigs.fasta
nhmmer --tblout 200_scaffolds.tbl  -o 200_scaffolds.out ../Pf_prophage_strain_PAO1__Reference_strain_.fasta 200_filtered_scaffolds.fasta
nhmmer --tblout 1k_scaffolds.tbl  -o 1k_scaffolds.out ../Pf_prophage_strain_PAO1__Reference_strain_.fasta 1k_filtered_scaffolds.fasta

nhmmer --tblout contigs/PAO1_rec_Pf4_1k.tbl -o contigs/PAO1_rec_Pf4_1k.out Pf_prophage_strain_PAO1__Reference_strain_.fasta contigs/PAO1_rec_Pf4_1k.fasta
nhmmer --tblout contigs/PAO1_rec_Pf4_200.tbl -o contigs/PAO1_rec_Pf4_200.out Pf_prophage_strain_PAO1__Reference_strain_.fasta contigs/PAO1_rec_Pf4_200.fasta
nhmmer --tblout contigs/PAO1_wt_Pf4_200.tbl -o contigs/PAO1_wt_Pf4_200.out Pf_prophage_strain_PAO1__Reference_strain_.fasta contigs/PAO1_wt_Pf4_200.fasta
nhmmer --tblout contigs/PAO1_wt_Pf4_1k.tbl -o contigs/PAO1_wt_Pf4_1k.out Pf_prophage_strain_PAO1__Reference_strain_.fasta contigs/PAO1_wt_Pf4_1k.fasta

(PAO1OR)
nhmmer --tblout contigs/PAO1_wt_Pf4_1k_PAO1OR.tbl -o contigs/PAO1_wt_Pf4_1k_PAO1OR.out Pseudomonas_aeruginosa_genome_assembly_PAO1OR.fasta contigs/PAO1_wt_Pf4_1k.fasta

=====
Stanford Mini-Pipeline (Mid-Late October 2018)
hmmbuild --amino coab_les.hmm coaB_LES.fasta
hmmbuild --amino coab_pf4.hmm coaB_Pf4.fasta

See text_files folder for msub cluster commands

phmmert -o text_files/phmmert_out/les/e(e-value).out sequence_files/hmm/coab_(isoform).hmm sequence_files/pseudomonas/(genome)

=====
Attempt to address poorly defined viral sequences (January 2019)
nhmmer -o ref_vs_all_prophage.afa Pf_prophage_strain_PAO1__Reference_strain_.fasta prophage_seq/prophage_seq.fasta

=====
Viral Genome Alignment to TIGRFAM DB (Jan 2019)
hmmscant --tblout protein_annotated_prophages.tbl TIGRFAM.HMM ../prophage/prophage_seq.fasta

(this one yielded actual table we're actually going to use as of 1/29)
 hmmscant --domtblout protein_annotated_prophages.domtbl TIGRFAM.HMM ../prophage/prophage_seq.fasta

 =====
 Thu Jun  6 14:27:47 MDT 2019
Annotating Pseudomonas Prophages with Viral Protein Database (from uniprot reference seqs)

Downloaded reviewed viral proteins from https://www.uniprot.org/uniprot/?query=reviewed:yes%20taxonomy:10239

On bioinfo:
perl hmmbuild_mult_seq.pl --input ../seq/viral_proteins_swissprot/uniprot-reviewed-viral.fasta --output ../hmm/viral_proteins/swissprot_viral_prots.hmm --amino --cpu 4 --verbose

hmmpress swissprot_viral_prots.hmm

hmmscant --domtblout tables/domtbl/uniprot_annotated_prophages.domtbl hmm/viral_proteins/swissprot_viral_prots.hmm seq/prophage_seq/prophage_seq.fasta (goddamnit, wrong program...)

perl fasta_split.pl --input ../../../sequence_files/prophage/prophage_seq.fasta --output ../../../sequence_files/prophage/individual_phage/

python3 generate_domtbls.py ../seq/prophage_seq/individual_phage/ ../hmm/viral_proteins/swissprot_viral_prots.hmm ../tables/domtbl/ (on bioinfo)

hmmstat swissprot_viral_prots.hmm >swissprot_viral_prots.hmmstat

downloaded all complete genomes from pseudomonas.com: http://pseudomonas.com/strain/download?c1=organism&v1=&v2=complete&c2=assemblyLevel (335 at time of writing on June 14th)

perl hmmbuild_mult_seq.pl --input ../../../sequence_files/prophage/prophage_seq.fasta --output ../../../hmm/prophage_genomes/50_ref_phage.hmm --verbose

hmmpress 50_ref_phage.hmm

Ran 2019-06-14_complete.sh on HPC (50 reference phages vs. 335 complete Ps genomes from pseudomonas.com)

Ran 2019-06-19_table_parser_complete.sh on HPC

perl scan_domtbls.pl --input ../../../tables/domtbl/viral_prot_unscanned/ --output ../../../tables/domtbl/2019-06-21_viral_prot_scanned/ (output available in 2019-06-21_scan_domtbls) (Redid this command after editing scan_domtbls to sort output by sequence start location rather than e-value)

Thu Jun 27 15:28:59 MDT 2019
Added Pat's recombinase, pseudogene seq to viral protein database in uniprot-reviewed-and-pat-seq.fasta
perl hmmbuild_mult_seq.pl --input ../seq/viral_proteins_swissprot/uniprot-reviewed-and-pat-seq.fasta --output ../hmm/viral_proteins/swissprot_and_pat_seq.hmm --amino --cpu 6 --verbose on bioinfo)

python3 generate_domtbls.py ../seq/prophage_seq/individual_phage/ ../hmm/viral_proteins/swissprot_and_pat_seq.hmm ../tables/domtbl/2019-06-27_viral_prot_swiss_pat_unscanned/ (on bioinfo)

perl scan_domtbls.pl --input ../../../tables/domtbl/2019-06-27_viral_prot_swiss_pat_unscanned/ --output ../../../tables/domtbl/2019-06-27_viral_prot_swiss_pat_scanned/ --verbose

perl combine_charts.pl --inputdir ../../../tables/nuc_chart/2019-06-19_complete --outputdir ../../../tables/nuc_chart/2019-06-19_complete_combined_test/ --verbose
(generated lab meeting chart counts)

esl-sfetch -o LES400_partial.fasta -c 10600..13728 Pf_prophage_strain_LES400.fasta "Pf_prophage_strain_LES400"

esl-sfetch -o X13273_1374860_partial -c 3600..5500 Pf_prophage_strain_X13273_1374860–1380892.fasta Pf_prophage_strain_X13273_1374860–1380892

esl-translate LES400_partial.fasta

esl-translate X13273_1374860_partial.fasta

==== Add Pfam to annotate step

Downloaded Pfam-A.hmm.gz from ftp://ftp.ebi.ac.uk/pub/databases/Pfam/current_release on Wed Jul  3 17:00:54 MDT 2019

gunzip Pfam-A.hmm.gz

python3 generate_domtbls.py ../seq/prophage_seq/individual_phage/ ../hmm/Pfam_A/Pfam-A.hmm ../tables/domtbl/2019-07-03_Pfam_A_prophage_unscanned/